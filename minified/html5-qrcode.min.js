!function(e){var t=2,a=2;function n(e){return 1e3/e}window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,jQuery.fn.extend({html5_qrcode:function(i,o,r,c,d){return this.each(function(){if(null==i)throw"cameraId is required";o="function"==typeof o?o:function(e){console.log("QR Code Success callback is undefined or not a function.")},r=r||function(e,i){},c="function"==typeof c?c:function(e){console.log("Error callback is undefined or not a function.",e)},(d=d||{}).fps=d.fps?d.fps:2;var s=e(this);s.html("");var u,f=null==s.height()?250:s.height(),v=null==s.width()?300:s.width(),l=e(function(e,i){return'<video width="'+e+'px" height="'+i+'px"></video>'}(v,f)).appendTo(s),h=e(function(e,i){return'<canvas id="qr-canvas" width="'+(e-a)+'px" height="'+(i-t)+'px" style="display:none;"></canvas>'}(v,f)).appendTo(s),g=l[0],p=h[0].getContext("2d"),m=function(){if(u){p.drawImage(g,0,0,v,f);try{qrcode.decode()}catch(e){r(e,u)}}e.data(s[0],"TIMEOUT_TAG",setTimeout(m,n(d.fps)))},T=function(i){g.srcObject=i,u=i,e.data(s[0],"STREAM_TAG",i),e.data(s[0],"TIMEOUT_TAG",setTimeout(m,n(d.fps))),g.play()};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:i}}).then(T).catch(T):navigator.getUserMedia?(qrcodeConfig={video:{optional:[{sourceId:i}]}},navigator.getUserMedia(qrcodeConfig,T,c)):c("Native web camera streaming (getUserMedia) not supported in this browser."),qrcode.callback=o})},html5_qrcode_stop:function(){return this.each(function(){e(this).data("STREAM_TAG").getVideoTracks().forEach(function(e){e.stop()}),e(this).children("video").remove(),e(this).children("canvas").remove(),clearTimeout(e(this).data("TIMEOUT_TAG"))})},html5_qrcode_getSupportedCameras:function(e,t){if("function"!=typeof e)throw"onSuccessCallback (1st argument) should be a function.";if(t="function"==typeof t?t:function(e){console.error("Unable to retreive supported cameras. Reason: ",e)},navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)navigator.mediaDevices.enumerateDevices().then(function(t){var a=[];for(i=0;i<t.length;i++){var n=t[i];"videoinput"==n.kind&&a.push({id:n.deviceId,label:n.label})}e(a)}).catch(function(e){t(e.name+": "+e.message)});else if("undefined"!=typeof MediaStreamTrack&&void 0!==MediaStreamTrack.getSources){MediaStreamTrack.getSources(function(t){var a=[];for(i=0;i!==t.length;++i){var n=t[i];"video"===n.kind&&a.push({id:n.id,label:n.label})}e(a)})}else t("unable to query supported devices.")}})}(jQuery);