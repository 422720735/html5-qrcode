!function(g){var p="TIMEOUT_TAG",m="STREAM_TAG";function w(e){return 1e3/e}window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,jQuery.fn.extend({html5_qrcode:function(u,f,v,l,h){return this.each(function(){if(null==u)throw"cameraId is required";f="function"==typeof f?f:function(e){console.log("QR Code Success callback is undefined or not a function.")},v=v||function(e,i){},l="function"==typeof l?l:function(e){console.log("Error callback is undefined or not a function.",e)},(h=h||{}).fps=h.fps?h.fps:2;var i=g(this);i.html("");function e(e){c.srcObject=e,t=e,g.data(i[0],m,e),g.data(i[0],p,setTimeout(s,w(h.fps))),c.play()}var t,a=null==i.height()?250:i.height(),n=null==i.width()?300:i.width(),o=g('<video width="'+n+'px" height="'+a+'px"></video>').appendTo(i),r=g('<canvas id="qr-canvas" width="'+(n-2)+'px" height="'+(a-2)+'px" style="display:none;"></canvas>').appendTo(i),c=o[0],d=r[0].getContext("2d"),s=function(){if(t){d.drawImage(c,0,0,n,a);try{qrcode.decode()}catch(e){v(e,t)}}g.data(i[0],p,setTimeout(s,w(h.fps)))};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:{exact:u}}}).then(e).catch(e):navigator.getUserMedia?(qrcodeConfig={video:{optional:[{sourceId:u}]}},navigator.getUserMedia(qrcodeConfig,e,l)):l("Native web camera streaming (getUserMedia) not supported in this browser."),qrcode.callback=f})},html5_qrcode_stop:function(){return this.each(function(){g(this).data(m).getVideoTracks().forEach(function(e){e.stop()}),g(this).children("video").remove(),g(this).children("canvas").remove(),clearTimeout(g(this).data(p))})},html5_qrcode_getSupportedCameras:function(n,t){if("function"!=typeof n)throw"onSuccessCallback (1st argument) should be a function.";if(t="function"==typeof t?t:function(e){console.error("Unable to retreive supported cameras. Reason: ",e)},navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)navigator.mediaDevices.enumerateDevices().then(function(e){var t=[];for(i=0;i<e.length;i++){var a=e[i];"videoinput"==a.kind&&t.push({id:a.deviceId,label:a.label})}n(t)}).catch(function(e){t(e.name+": "+e.message)});else if("undefined"!=typeof MediaStreamTrack&&void 0!==MediaStreamTrack.getSources){MediaStreamTrack.getSources(function(e){var t=[];for(i=0;i!==e.length;++i){var a=e[i];"video"===a.kind&&t.push({id:a.id,label:a.label})}n(t)})}else t("unable to query supported devices.")}})}(jQuery);